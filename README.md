# webdrawer with platform service

## 1. 프로젝트 개요

- **프로젝트명:** webdraw
- **설명:** 웹 캐치마인드 백엔드 개발
- **개발 목표:**
  - 웹 캐치마인드 게임 개발 – 엑셀 및 IDE를 프론트엔드 테마로 활용하여, 직장인들이 업무시간에 가볍게 즐길 수 있도록 제작
  - MSA 기반 API 설계 – 게임 플레이 API와 게임 플랫폼 API를 분리하여 개발, 플랫폼 서비스에 추가 게임을 쉽게 런칭할 수 있는 구조로 아키텍처 구성
- **대상 사용자:** 웹 브라우저로 캐치마인드를 플레이하려는 유저 (주 타겟 -> 직장인)

## 2. 서비스 아키텍처 개요

- **아키텍처 유형:** MSA
- **핵심 서비스 구성:**

```yaml
목록:
  - 서비스: api-gateway
    컨테이너: Spring Boot
    설명: 전체 서비스의 엔드포인트 역할 및 공통 처리를 담당하는 API 게이트웨이 서비스
  - 서비스: platform-service
    컨테이너: Spring Boot
    설명: 게임 플레이 외에 대기실, 게임 방 접속 기능 등의 서비스를 제공하는 플랫폼 서비스
  - 서비스: webdrawer-service
    컨테이너: Spring Boot
    설명: 캐치마인드 게임 서버의 역할을 담당하는 서비스로 웹 소켓서버, 게임 기록 등의 서비스를 담당
```

## 3. 핵심 기능

- 🔹 캐치마인드 플레이 기능
  - #### ✅ 기능 요구사항 (FR)
    - 동일한 게임에 접속해있는 유저들은 한 게임 내에서 순서대로 한 번씩 화면에 그림을 마우스로 그릴 수 있다.
    - 각 턴마다 랜덤한 제시어가 생성된다. 
    - 그림을 그리는 차례의 유저는 해당 턴에 생성된 제시어를 볼 수 있다.
    - 동일한 게임에 접속해있는 유저들은 게임 내에서 그려지는 그림을 동시에 볼 수 있다.
    - 동일한 게임에 접속해있는 유저들간에는 실시간으로 채팅이 가능하다.
    - 동일한 게임에 접속해있는 유저들 중 채팅에 주어진 제시어를 입력하면 다음과 같이 동작한다.
      - 그림을 그리는 차례의 유저 : 채팅을 입력한 유저에게 패널티가 주어지고 다음 유저에게 턴이 넘어간다.
      - 그 외 유저 : 채팅을 입력한 유저에게 점수가 주어지고 다음 유저에게 턴이 넘어간다.

  - #### 🚀 비기능 요구사항 (NFR)
    - 유저가 재접속시에 세션이 유지되어야 하는가?

- 🔹 플랫폼 기능
  - #### ✅ 기능 요구사항 (FR)
    - 유저는 현재 생성되어있는 게임 방의 목록을 볼 수 있다.
    - 유저는 게임 방 생성을 요청할 수 있다.
      - 유저는 게임 방을 비공개로 생성할 수 있다.
      - 유저가 요청한 게임 방 생성이 완료되면 자동으로 방을 식별할 수 있는 코드가 함께 생성되고 방의 호스트는 코드를 확인할 수 있다.
    - 유저는 생성되어있는 게임 방에 입장할 수 있다.
      - 현재 생성되어있는 게임 방의 목록에서 하나의 방을 직접 선택해 입장할 수 있다.
      - 게임 방의 호스트에게 공유받은 코드를 입력해 게임 방에 입장할 수 있다.
    - 유저는 대기실의 테마를 선택할 수 있다.
      - IDE 테마 for developer
      - Excel 테마 for officer
      - VIM 테마 for server engineer
      
  - #### 🚀 비기능 요구사항 (NFR)

- 🔹 API 게이트웨이 로깅 기능 → 설명

## 4. 기술 스택

| 영역          | 기술                |
|-------------|-------------------|
| 백엔드         | Spring Boot, Java |
| 데이터베이스      | MySQL, Redis      |
| API 통신      | REST              |
| 인증 방식       | 토큰 기반 인증          |
| 메시징         | Kafka             |

## 5. 데이터 흐름 및 API 설계 방향

- 서비스 간 데이터 흐름 정리 (간략한 설명)
- API 설계 기본 원칙 (RESTful / GraphQL 등)
- 요청 및 응답 패턴 예시

## 6. 개발 로드맵

- ✅ **1단계:** MVP 개발 (핵심 기능 구현)
- 🚀 **2단계:** 확장 및 배포 (부하 테스트 & 최적화)
- 🌍 **3단계:** 운영 및 유지보수

## 7. 기타 참고 사항

- (관련 문서, 참고 자료 링크)
- (추가적인 확장 계획)

#### 로그인 없이 토큰 기반 인증처리 예시
```
로그인 없이 JWT로 인증을 처리하는 방식은 **"토큰 기반 인증"**을 활용하는 서비스에서 종종 사용돼. 특히, 로그인 없이 사용자 식별이 필요한 경우 JWT를 발급하는 방식이 많아.

🚀 로그인 없이 JWT를 활용하는 대표적인 서비스 예시

1️⃣ Slack의 Guest Token (비로그인 API 인증)
사용 사례: Slack에서는 일부 퍼블릭 API를 사용할 때 로그인 없이도 특정 기능을 수행할 수 있도록 Guest Token 개념을 사용해.
JWT 활용: Slack은 사용자 로그인 없이 API를 호출할 수 있도록 임시 JWT를 발급하고, 이 토큰을 이용해 특정 API를 인증하는 방식이야.
적용 아이디어: 게임 방 입장 시 임시 JWT 발급 → JWT를 클라이언트가 저장 → 이후 요청에서 JWT를 인증 수단으로 사용

2️⃣ GitHub Gist (익명 사용자 지원)
사용 사례: GitHub Gist는 로그인을 하지 않아도 익명으로 코드 스니펫을 생성할 수 있어.
JWT 활용: 로그인 없이 생성된 Gist에는 익명 사용자를 위한 임시 인증 토큰이 부여되며, 해당 토큰을 통해 일정 기간 동안 수정 가능.
적용 아이디어: 유저가 게임을 시작하면 임시 JWT를 발급 → JWT를 기반으로 게임 내 권한을 관리

3️⃣ Google reCAPTCHA (세션 없이 JWT 사용)
사용 사례: Google reCAPTCHA는 사용자의 로그인을 요구하지 않지만, 클라이언트별 인증이 필요해.
JWT 활용: Google은 reCAPTCHA 실행 시 클라이언트에게 JWT 같은 토큰을 발급하고, 이를 서버 검증 후 처리해.
적용 아이디어: 게임 시작 시 JWT를 클라이언트에 전달 → API 요청 시 해당 JWT를 인증

4️⃣ Firebase Anonymous Authentication (임시 사용자 개념)
사용 사례: Firebase는 로그인 없이 앱을 이용할 수 있도록 익명 사용자 기능을 제공해.
JWT 활용: Firebase는 익명 사용자에게 임시 JWT를 발급하고, 나중에 정식 로그인 시 해당 데이터를 유지할 수 있도록 설계.
적용 아이디어: 클라이언트가 처음 접속하면 임시 JWT 발급 → JWT로 유저 상태를 유지

🔥 결론: 비로그인 JWT 운영이 가능한 구조

✅ 비로그인 JWT 인증 설계 방향
클라이언트가 처음 API 호출 시 서버에서 JWT 발급
예시: POST /auth/init → { "token": "<JWT>" }
JWT를 클라이언트가 저장하고 이후 요청에 포함
예시: Authorization: Bearer <JWT>
JWT 만료시간을 적절히 설정 (짧은 TTL + Refresh 가능 여부 고려)

예시: exp 30분 설정 + 갱신 API 제공 (/auth/refresh)
게임 방 입장 시 JWT를 사용해 클라이언트 식별
JWT 페이로드에 guestId 혹은 sessionId 포함
```
